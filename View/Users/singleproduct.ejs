<%- include('../layouts/userHeader.ejs')%>

<div class="hero-wrap hero-bread" style="background-image: url('images/bg_1.jpg');">
  <div class="container">
	<div class="row no-gutters slider-text align-items-center justify-content-center">
	  <div class="col-md-9 ftco-animate text-center">
		  <p class="breadcrumbs"><span class="mr-2"><a href="index.html"></a></span> <span class="mr-2"><a href="index.html"></a></span> <span></span></p>
		<h1 class="mb-0 bread">Product Single</h1>
	  </div>
	</div>
  </div>
</div>

<section class="ftco-section">
	<div class="container">
		<div class="row">

			<div class="col-lg-6 d-flex gap-1">

				<div class="">
					<% singleProduct.productImage.forEach(function(image) { %>
						<div class="my-5">
							<img onclick="change_image(this)" src="/images/<%=image%>" width="100" height="100" style="border: 1px solid rgba(128, 128, 128, 0.386);" />
						</div>
						<% }) %>
				</div>
					
				<div class="ftco-animate">
					<a  class="image-popup">
						<img src="/images/<%=singleProduct.productImage[0] %>" alt="" id="main-image" width="500px" height="500px" style="object-fit: contain;">
					</a>
				</div>
			</div>

			<div class="col-lg-6 product-details pl-md-5 ftco-animate">
				<h3><%= singleProduct.productName %></h3>
				<div class="rating d-flex">
						<!-- <p class="text-left mr-4">
							<a href="#" class="mr-2">5.0</a>
							<a href="#"><span class="ion-ios-star-outline"></span></a>
							<a href="#"><span class="ion-ios-star-outline"></span></a>
							<a href="#"><span class="ion-ios-star-outline"></span></a>
							<a href="#"><span class="ion-ios-star-outline"></span></a>
							<a href="#"><span class="ion-ios-star-outline"></span></a>
						</p> -->
						<!-- <p class="text-left mr-4">
							<a href="#" class="mr-2" style="color: #000;">100 <span style="color: #bbb;">Rating</span></a>
						</p> -->
						<!-- <p class="text-left">
							<a href="#" class="mr-2" style="color: #000;">500 <span style="color: #bbb;">Sold</span></a>
						</p> -->
					</div>
				<p class="price"><span>â‚¹<%= singleProduct.price %></span></p>
				<p class="description"><span><%= singleProduct.productDescription %></span></p>
					<div class="row mt-4">
						<div class="col-md-6">
							<div class="form-group d-flex">
				  <div class="select-wrap">
				  <!-- <div class="icon"><span class="ion-ios-arrow-down"></span></div> -->
				  <!-- <select name="" id="" class="form-control">
					  <option value="">Small</option>
					<option value="">Medium</option>
					<option value="">Large</option>
					<option value="">Extra Large</option>
				  </select> -->
				</div>
				</div>
						</div>
						
						<div class="w-100"></div>
						
						<div class="input-group col-md-6 d-flex mb-3">
							<span class="input-group-btn">
								<button class="btn btn-default" onclick="decrementCount('<%= singleProduct._id %>')"
									type="button">
									-
								</button>
							</span>
							<input type="text" id="countInput" class="form-control" value="1" readonly />
							<span class="input-group-btn">
								<button class="btn btn-default" onclick="incrementCount('<%= singleProduct._id %>')"
									type="button">
									+
								</button>
							</span>
						  </div>
						  
			
			  <div class="w-100"></div>
			  <div class="col-md-12">
				  <p style="color: #000;">600 kg available</p>
			  </div>
		  </div>
		  <p><a href="" class="btn btn-black py-3 px-5" onclick="showAddtoCartConfirmation(event, '<%= singleProduct._id %>',parseInt(document.getElementById('countInput').value))" >Add to Cart</a></p>
				 
		 
		  <p><a href="/cart" class="btn btn-black py-3 px-5" >Go to Cart</a></p>
			</div>
			
		</div>
		</div>
	</div>
</section>

<!-- <section class="ftco-section">
	<div class="container">
			<div class="row justify-content-center mb-3 pb-3">
	  <div class="col-md-12 heading-section text-center ftco-animate">
		  <span class="subheading">Products</span>
		<h2 class="mb-4">Related Products</h2>
		<p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia</p>
	  </div>
	</div>   		
	</div>
	<div class="container">
		<div class="row">
			<div class="col-md-6 col-lg-3 ftco-animate">
				<div class="product">
					<a href="#" class="img-prod"><img class="img-fluid" src="images/product-1.jpg" alt="Colorlib Template">
						<span class="status">30%</span>
						<div class="overlay"></div>
					</a>
					<div class="text py-3 pb-4 px-3 text-center">
						<h3><a href="#">Bell Pepper</a></h3>
						<div class="d-flex">
							<div class="pricing">
								<p class="price"><span class="mr-2 price-dc">$120.00</span><span class="price-sale">$80.00</span></p>
							</div>
						</div>
						<div class="bottom-area d-flex px-3">
							<div class="m-auto d-flex">
								<a href="#" class="add-to-cart d-flex justify-content-center align-items-center text-center">
									<span><i class="ion-ios-menu"></i></span>
								</a>
								<a href="#" class="buy-now d-flex justify-content-center align-items-center mx-1">
									<span><i class="ion-ios-cart"></i></span>
								</a>
								<a href="#" class="heart d-flex justify-content-center align-items-center ">
									<span><i class="ion-ios-heart"></i></span>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-6 col-lg-3 ftco-animate">
				<div class="product">
					<a href="#" class="img-prod"><img class="img-fluid" src="images/product-2.jpg" alt="Colorlib Template">
						<div class="overlay"></div>
					</a>
					<div class="text py-3 pb-4 px-3 text-center">
						<h3><a href="#">Strawberry</a></h3>
						<div class="d-flex">
							<div class="pricing">
								<p class="price"><span>$120.00</span></p>
							</div>
						</div>
						<div class="bottom-area d-flex px-3">
							<div class="m-auto d-flex">
								<a href="#" class="add-to-cart d-flex justify-content-center align-items-center text-center">
									<span><i class="ion-ios-menu"></i></span>
								</a>
								<a href="#" class="buy-now d-flex justify-content-center align-items-center mx-1">
									<span><i class="ion-ios-cart"></i></span>
								</a>
								<a href="#" class="heart d-flex justify-content-center align-items-center ">
									<span><i class="ion-ios-heart"></i></span>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-6 col-lg-3 ftco-animate">
				<div class="product">
					<a href="#" class="img-prod"><img class="img-fluid" src="images/product-3.jpg" alt="Colorlib Template">
						<div class="overlay"></div>
					</a>
					<div class="text py-3 pb-4 px-3 text-center">
						<h3><a href="#">Green Beans</a></h3>
						<div class="d-flex">
							<div class="pricing">
								<p class="price"><span>$120.00</span></p>
							</div>
						</div>
						<div class="bottom-area d-flex px-3">
							<div class="m-auto d-flex">
								<a href="#" class="add-to-cart d-flex justify-content-center align-items-center text-center">
									<span><i class="ion-ios-menu"></i></span>
								</a>
								<a href="#" class="buy-now d-flex justify-content-center align-items-center mx-1">
									<span><i class="ion-ios-cart"></i></span>
								</a>
								<a href="#" class="heart d-flex justify-content-center align-items-center ">
									<span><i class="ion-ios-heart"></i></span>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-6 col-lg-3 ftco-animate">
				<div class="product">
					<a href="#" class="img-prod"><img class="img-fluid" src="images/product-4.jpg" alt="Colorlib Template">
						<div class="overlay"></div>
					</a>
					<div class="text py-3 pb-4 px-3 text-center">
						<h3><a href="#">Purple Cabbage</a></h3>
						<div class="d-flex">
							<div class="pricing">
								<p class="price"><span>$120.00</span></p>
							</div>
						</div>
						<div class="bottom-area d-flex px-3">
							<div class="m-auto d-flex">
								<a href="#" class="add-to-cart d-flex justify-content-center align-items-center text-center">
									<span><i class="ion-ios-menu"></i></span>
								</a>
								<a href="#" class="buy-now d-flex justify-content-center align-items-center mx-1">
									<span><i class="ion-ios-cart"></i></span>
								</a>
								<a href="#" class="heart d-flex justify-content-center align-items-center ">
									<span><i class="ion-ios-heart"></i></span>
								</a>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</section> -->

	<section class="ftco-section ftco-no-pt ftco-no-pb py-5 bg-light">
  <div class="container py-4">
	<div class="row d-flex justify-content-center py-5">
	  <div class="col-md-6">
		  <h2 style="font-size: 22px;" class="mb-0">Subcribe to our Newsletter</h2>
		  <span>Get e-mail updates about our latest shops and special offers</span>
	  </div>
	  <div class="col-md-6 d-flex align-items-center">
		<form action="#" class="subscribe-form">
		  <div class="form-group d-flex">
			<input type="text" class="form-control" placeholder="Enter email address">
			<input type="submit" value="Subscribe" class="submit px-3">
		  </div>
		</form>
	  </div>
	</div>
  </div>
</section>



<%- include('../layouts/userFooter.ejs')%>

		

		<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
		<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script> -->



		

		

<script>

function change_image(image) {
			var container = document.getElementById("main-image");
			container.src = image.src;
			$(document).ready(function() {
    $(".zoomGallery").elevateZoom({
      zoomWindowPosition: 1,
      zoomWindowWidth: 300,
      zoomWindowHeight: 300,
      gallery: "thumbnail",
      cursor: "crosshair",
      galleryActiveClass: "active",
      responsive: true,
      zoomWindowFadeIn: 500,
      zoomWindowFadeOut: 500,
      lensFadeIn: 500,
      lensFadeOut: 500,
      zoomWindowContainerClass: "zoom-display"
    });
  });
}
		// Function to handle count increment
		function incrementCount(productId) {
			var countInput = document.getElementById("countInput");
			var count = parseInt(countInput.value) + 1;

			// Update the input value
			countInput.value = count;

		}

		// Function to handle count decrement
		function decrementCount(productId) {
			var countInput = document.getElementById("countInput");
			var count = parseInt(countInput.value) - 1;

			// Ensure count doesn't go below 1
			count = Math.max(count, 1);

			// Update the input value
			countInput.value = count;

			// Send AJAX request to update the count in the database
			
		}
	
				

		function showAddtoCartConfirmation(event,productId,count){
			event.preventDefault()
			
			swal
			({
				title: "Add to cart",
				text: "Are you sure you want to add this item to your cart?",
				
				showCancelButton: true,
				buttons:[ "Cancel","Add to cart"],
				
			}).then((addToCart)=>
				{
					if(addToCart){
						addToCartRequest(event,productId,count)
					}
				})
		}

		function addToCartRequest(event,productId,count){
			var addButton = event.target
			console.log("test");
			addButton.disabled=true

			var data={ productId:productId,count:count }

			fetch("/addToCart", {
				method:"POST",
				headers:{
					"Content-Type":"application/json"
				},
				body: JSON.stringify(data),
			})
			

			.then((response)=> response.json())
			.then((response)=>{
				
				var cartCount=parseInt(document.getElementById("cartCount").innerText)
				console.log(document.getElementById("cartCount").innerText);
				document.getElementById("cartCount").innerText=cartCount +1
				addButton.disabled=false
			})
			.catch((error)=>{
				console.error("Error adding product to cart:", error)
				addButton.disabled=false
			})
		}




	</script>

  