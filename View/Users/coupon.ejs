<%- include('../layouts/userHeader.ejs')%>

  <section class="h-100 gradient-custom">
    <div class="container py-5 h-100">
      <div class="row d-flex justify-content-center align-items-center h-100">
        <% for (let i=0; i < coupon.length; i++) { %>
          
          <div class="col-lg-10 col-xl-8 mb-4">
            <div data-id="<%=coupon._id %>" class="coupon">
              <div class="card p-2" style="border-radius: 10px; color: black;">


                <div class="card-body">
                  <div class="d-flex justify-content-between align-items-center gap-2">
                    
                    <p class="lead fw-strong mb-0 couponcode" style="color: #82ae46; ">
                      <%= coupon[i].couponCode %>
                    </p>
                  



                    <p class="small text-muted mb-0"> </p>
                  </div>
                </div>
                <div class="d-flex ps-4">
                 
                  <p class="text-muted h6 couponDescription">
                    <%=coupon[i].description%>
                  </p>
             

                </div>
                <div class="d-flex justify-content-between mb-6">
                  
                  <p class="text-danger mb-0 couponStartDate">Validity: <%=coupon[i].startDate.toDateString()%> -
                      <%=coupon[i].expiryDate.toDateString()%>
                  </p>
                

                </div>
              </div>
              <div class="card-footer border-0 px-4 py-4"
                style="background-color: #82ae46; border-bottom-left-radius: 10px; border-bottom-right-radius: 10px;">
                <h5 class="d-flex align-items-center justify-content-centre text-white text-uppercase mb-0 couponAmount">
                  Discount Amount: â‚¹<%=coupon[i].couponAmount %> <span class="h2 mb-0 ms-2"> </span></h5>
              </div>
            </div>
          </div>

          <% } %>
      </div>
    </div>
    
  </section>



  <%- include('../layouts/userFooter.ejs')%>

    <script>

      const coupons = document.querySelectorAll('.coupon')
      coupons.forEach(function(coupon) {
        coupon.addEventListener('click', function(){
          const couponData ={
            couponId:coupon.getAttribute('data-id'),
            code: coupon.querySelector('.coupon'),
            discountAmount: coupon.querySelector('.couponDescription'),
            startDate: coupon.querySelector('.couponStartDate'),
            amount: coupon.querySelector('.couponAmount')
          }
          const { couponId, code, discountAmount }= couponData

          const queryParams =`?couponId=${couponId}&code=${code}&discountAmount=${discountAmount}`
          window.location.href="/checkout"+ queryParams
          
        })
      })
    </script>